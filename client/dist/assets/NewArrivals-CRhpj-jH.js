import{r as N,z as j,c as w,k as v,u as b,j as e,L as p,e as n}from"./index-DFyuifyJ.js";import{u as k}from"./useMutation-C0jg7rW6.js";import{d as E,b as A}from"./newArrivalService-BWgqCLlP.js";const L=(r,c=!1)=>{if(!r)return"N/A";const l=typeof r=="string"?new Date(r):r;if(isNaN(l.getTime()))return"Invalid Date";const i={year:"numeric",month:"short",day:"numeric"};return c&&(i.hour="2-digit",i.minute="2-digit"),l.toLocaleDateString("en-US",i)},q=()=>{const[r,c]=N.useState(!1),l=j(),i=w(),{user:o,loading:h}=v(),{data:d,isLoading:u,error:g}=b({queryKey:["adminNewArrivals"],queryFn:A,enabled:!!o&&o.role==="admin",onError:s=>{var t,a;((t=s.response)==null?void 0:t.status)===401?(n.error("Please log in to access this page"),i("/login")):((a=s.response)==null?void 0:a.status)===403?(n.error("You do not have permission to access this page"),i("/")):n.error("Error loading new arrivals")}}),f=k({mutationFn:E,onSuccess:()=>{l.invalidateQueries({queryKey:["adminNewArrivals"]}),n.success("New arrival deleted successfully")},onError:s=>{var t,a,x,m;((t=s.response)==null?void 0:t.status)===401?(n.error("Please log in to perform this action"),i("/login")):((a=s.response)==null?void 0:a.status)===403?n.error("You do not have permission to perform this action"):n.error(((m=(x=s.response)==null?void 0:x.data)==null?void 0:m.message)||"Error deleting new arrival")}}),y=async s=>{if(window.confirm("Are you sure you want to delete this new arrival?")){c(!0);try{await f.mutateAsync(s)}catch(t){console.error("Error deleting new arrival:",t)}finally{c(!1)}}};return h?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):!o||o.role!=="admin"?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"text-red-500",children:"You do not have permission to access this page"})}):u?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):g?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"text-red-500",children:"Error loading new arrivals"})}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"New Arrivals"}),e.jsx(p,{to:"/admin/new-arrivals/new",className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition duration-300",children:"Add New Arrival"})]}),(d==null?void 0:d.length)===0?e.jsx("div",{className:"bg-white shadow-md rounded-lg p-6 text-center",children:e.jsx("p",{className:"text-gray-500",children:"No new arrivals found. Add your first new arrival!"})}):e.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Image"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created At"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d==null?void 0:d.map(s=>{var t,a;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("img",{className:"h-10 w-10 rounded-full object-cover",src:s.image||"https://placehold.co/100x100?text=No+Image",alt:s.name})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:((t=s.productId)==null?void 0:t.name)||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-900",children:["$",((a=s.price)==null?void 0:a.toFixed(2))||"0.00"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:s.category||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:L(s.createdAt)})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[e.jsx(p,{to:`/admin/new-arrivals/${s._id}/edit`,className:"text-indigo-600 hover:text-indigo-900 mr-4",children:"Edit"}),e.jsx("button",{onClick:()=>y(s._id),disabled:r,className:"text-red-600 hover:text-red-900",children:r?"Deleting...":"Delete"})]})]},s._id)})})]})})})]})};export{q as default};
