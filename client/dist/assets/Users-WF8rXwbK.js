import{r as a,j as e,z as Q,u as $,V as m}from"./index-DFyuifyJ.js";import{u as v}from"./useMutation-C0jg7rW6.js";import{u as P,e as B,f as I,h as T}from"./adminService-lch1zYjo.js";import{B as u}from"./Button-DN5n5fSN.js";import{F as z}from"./XMarkIcon-DjkKpwdS.js";function O({title:n,titleId:i,...c},x){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:x,"aria-labelledby":i},c),n?a.createElement("title",{id:i},n):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const V=a.forwardRef(O),K=({isOpen:n,onClose:i,onSubmit:c,isLoading:x})=>{const[r,g]=a.useState({name:"",email:"",password:"",role:"user",phone:""}),l=d=>{const{name:y,value:h}=d.target;g(o=>({...o,[y]:h}))},t=d=>{d.preventDefault(),c(r)};return n?e.jsx("div",{className:"fixed inset-0  bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full relative",children:[e.jsx("button",{onClick:i,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:e.jsx(z,{className:"h-6 w-6"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Add New User"}),e.jsxs("form",{onSubmit:t,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:["Full Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"name",name:"name",value:r.name,onChange:l,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#39b54a] focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",id:"email",name:"email",value:r.email,onChange:l,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#39b54a] focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:["Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"password",id:"password",name:"password",value:r.password,onChange:l,required:!0,minLength:8,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#39b54a] focus:border-transparent"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Password must be at least 8 characters long"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:r.phone,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#39b54a] focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-1",children:["Role ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:"role",name:"role",value:r.role,onChange:l,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#39b54a] focus:border-transparent",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(u,{type:"button",variant:"secondary",onClick:i,children:"Cancel"}),e.jsx(u,{type:"submit",variant:"primary",loading:x,className:"bg-[#39b54a]",children:"Create User"})]})]})]})}):null},X=()=>{const[n,i]=a.useState(""),[c,x]=a.useState("all"),r=Q(),[g,l]=a.useState(!1),[t,d]=a.useState(null),[y,h]=a.useState(!1),[o,b]=a.useState(null),[S,j]=a.useState(!1),[U,w]=a.useState(!1),{data:k=[],isLoading:F}=$({queryKey:["users"],queryFn:T}),N=v({mutationFn:({userId:s,status:p})=>P(s,p),onSuccess:()=>{r.invalidateQueries(["users"])}}),A=v({mutationFn:B,onSuccess:()=>{r.invalidateQueries(["users"])}}),D=v({mutationFn:I,onSuccess:()=>{r.invalidateQueries(["users"]),m.success("User created successfully"),j(!1)},onError:s=>{m.error(s.message||"Failed to create user")}}),M=k.filter(s=>{const p=s.name.toLowerCase().includes(n.toLowerCase())||s.email.toLowerCase().includes(n.toLowerCase()),f=c==="all"||s.role===c;return p&&f}),E=s=>{b(s),h(!0)},C=async(s,p)=>{try{await N.mutate({userId:s,status:p}),m.success("User status updated successfully"),l(!1),d(null)}catch(f){console.error("Error updating user:",f),m.error(f.message)}},L=async()=>{if(o)try{await A.mutate(o.id),m.success("User deleted successfully")}catch(s){console.error("Error deleting user:",s),m.error(s.message)}finally{h(!1),b(null)}},R=async s=>{w(!0);try{await D.mutate(s)}finally{w(!1)}},q=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return F?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Users"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-1 max-w-lg",children:e.jsx("input",{type:"text",placeholder:"Search users...",value:n,onChange:s=>i(s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#39b54a] focus:border-transparent"})}),e.jsxs("select",{value:c,onChange:s=>x(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#39b54a] focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"user",children:"Users"}),e.jsx("option",{value:"admin",children:"Admins"})]}),e.jsxs(u,{variant:"primary",onClick:()=>j(!0),className:"flex items-center bg-[#39b54a] ",children:[e.jsx(V,{className:"h-5 w-5 mr-2 text-white"}),"Add User"]})]})]}),e.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created At"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:M.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:s.email})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:s.role})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${s.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:q(s.createdAt)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>N.mutate({userId:s.id,status:s.status==="active"?"inactive":"active"}),className:`text-sm font-medium ${s.status==="active"?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900"}`,children:s.status==="active"?"Deactivate":"Activate"}),e.jsx("button",{onClick:()=>E(s),className:"text-red-600 hover:text-red-900 text-sm font-medium",children:"Delete"})]})})]},s._id))})]})}),g&&e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Update User Status"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Change status for ",t==null?void 0:t.name]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{onClick:()=>C(t.id,"inactive"),className:`w-full px-4 py-2 text-sm font-medium rounded-md ${(t==null?void 0:t.status)==="inactive"?"bg-primary text-white":"bg-gray-100 text-gray-900 hover:bg-gray-200"}`,children:"Inactive"}),e.jsx("button",{onClick:()=>C(t.id,"active"),className:`w-full px-4 py-2 text-sm font-medium rounded-md ${(t==null?void 0:t.status)==="active"?"bg-primary text-white":"bg-gray-100 text-gray-900 hover:bg-gray-200"}`,children:"Active"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(u,{variant:"outline",onClick:()=>{l(!1),d(null)},children:"Cancel"})})]})}),y&&e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Delete User"}),e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Are you sure you want to delete ",o==null?void 0:o.name,"? This action cannot be undone."]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(u,{variant:"outline",onClick:()=>{h(!1),b(null)},children:"Cancel"}),e.jsx(u,{variant:"danger",onClick:L,children:"Delete"})]})]})}),e.jsx(K,{isOpen:S,onClose:()=>j(!1),onSubmit:R,isLoading:U})]})};export{X as default};
