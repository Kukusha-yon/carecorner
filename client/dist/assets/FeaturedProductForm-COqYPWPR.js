import{g as G,c as Q,z as J,r as f,u as _,j as e,X as h,e as p}from"./index-DFyuifyJ.js";import{u as C}from"./useMutation-C0jg7rW6.js";import{c as B,b as K,e as $}from"./featuredProductService-CWJSp5U4.js";import{P as D}from"./plus-eOj1peSO.js";const W=()=>{const{id:u}=G(),b=Q(),x=J(),m=!!u,[l,n]=f.useState({title:"",description:"",detailedDescription:"",image:"",galleryImages:[],order:0,isActive:!0,startDate:"",endDate:"",link:"",productId:"",buttonText:"",highlightText:"",features:[""],specifications:new Map,seoMetadata:{title:"",description:"",keywords:[]}}),[y,F]=f.useState([]),[S,j]=f.useState([]),[k,g]=f.useState([]),{data:i,isLoading:M}=_({queryKey:["featuredProduct",u],queryFn:()=>$(u),enabled:m});f.useEffect(()=>{var s;i&&(n({...i,startDate:i.startDate?new Date(i.startDate).toISOString().split("T")[0]:"",endDate:i.endDate?new Date(i.endDate).toISOString().split("T")[0]:"",features:i.features||[""],specifications:new Map(Object.entries(i.specifications||{})),seoMetadata:i.seoMetadata||{title:"",description:"",keywords:[]}}),g(((s=i.galleryImages)==null?void 0:s.map(t=>t.url))||[]))},[i]);const N=C({mutationFn:B,onSuccess:()=>{x.invalidateQueries(["featuredProducts"]),p.success("Featured product created successfully"),b("/admin/featured-products")},onError:s=>{var t,a;p.error(((a=(t=s.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to create featured product")}}),v=C({mutationFn:({id:s,data:t})=>K(s,t),onSuccess:()=>{x.invalidateQueries(["featuredProducts"]),x.invalidateQueries(["featuredProduct",u]),p.success("Featured product updated successfully"),b("/admin/featured-products")},onError:s=>{var t,a;p.error(((a=(t=s.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to update featured product")}}),o=s=>{const{name:t,value:a,type:r,checked:c}=s.target;if(t.includes(".")){const[d,z]=t.split(".");n(w=>({...w,[d]:{...w[d],[z]:a}}))}else n(d=>({...d,[t]:r==="checkbox"?c:a}))},P=(s,t)=>{n(a=>{const r=[...a.features];return r[s]=t,{...a,features:r}})},E=()=>{n(s=>({...s,features:[...s.features,""]}))},I=s=>{n(t=>({...t,features:t.features.filter((a,r)=>r!==s)}))},A=(s,t)=>{n(a=>{const r=new Map(a.specifications);return r.set(s,t),{...a,specifications:r}})},O=()=>{n(s=>{const t=new Map(s.specifications);return t.set("",""),{...s,specifications:t}})},T=s=>{n(t=>{const a=new Map(t.specifications);return a.delete(s),{...t,specifications:a}})},L=s=>{const t=s.target.files[0];if(t){F([t]);const a=new FileReader;a.onloadend=()=>{n(r=>({...r,image:a.result}))},a.readAsDataURL(t)}},q=s=>{const t=Array.from(s.target.files);t.length>0&&(j(a=>[...a,...t]),t.forEach(a=>{const r=new FileReader;r.onloadend=()=>{g(c=>[...c,r.result])},r.readAsDataURL(a)}))},R=s=>{j(t=>t.filter((a,r)=>r!==s)),g(t=>t.filter((a,r)=>r!==s))},U=async s=>{s.preventDefault();const t=new FormData;Object.keys(l).forEach(r=>{r!=="image"&&r!=="galleryImages"&&r!=="specifications"&&(r==="features"||r==="seoMetadata"?t.append(r,JSON.stringify(l[r])):t.append(r,l[r]))});const a=Object.fromEntries(l.specifications);t.append("specifications",JSON.stringify(a)),y[0]&&t.append("image",y[0]),S.forEach((r,c)=>{t.append("galleryImages",r)});try{m?await v.mutateAsync({id:u,data:t}):await N.mutateAsync(t)}catch(r){console.error("Error submitting form:",r)}};return M?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:m?"Edit Featured Product":"Add New Featured Product"}),e.jsxs("form",{onSubmit:U,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),e.jsx("input",{type:"text",name:"title",value:l.title,onChange:o,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",value:l.description,onChange:o,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:"3",required:!0})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Detailed Description"}),e.jsx("textarea",{name:"detailedDescription",value:l.detailedDescription,onChange:o,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:"5"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Main Image"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-4",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:L,className:`block w-full text-sm text-gray-500
                    file:mr-4 file:py-2 file:px-4
                    file:rounded-md file:border-0
                    file:text-sm file:font-semibold
                    file:bg-blue-600 file:text-white
                    hover:file:bg-blue-700
                    cursor-pointer`,required:!m}),l.image&&e.jsx("img",{src:l.image,alt:"Preview",className:"h-20 w-20 object-cover rounded-md"})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gallery Images"}),e.jsx("div",{className:"mt-1 flex items-center space-x-4",children:e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:q,className:`block w-full text-sm text-gray-500
                    file:mr-4 file:py-2 file:px-4
                    file:rounded-md file:border-0
                    file:text-sm file:font-semibold
                    file:bg-blue-600 file:text-white
                    hover:file:bg-blue-700
                    cursor-pointer`})}),e.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4",children:k.map((s,t)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:s,alt:`Gallery ${t+1}`,className:"h-24 w-24 object-cover rounded-md"}),e.jsx("button",{type:"button",onClick:()=>R(t),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1",children:e.jsx(h,{size:16})})]},t))})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Link URL"}),e.jsx("input",{type:"url",name:"link",value:l.link,onChange:o,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product ID"}),e.jsx("input",{type:"text",name:"productId",value:l.productId||"",onChange:o,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,placeholder:"Enter the ID of the product to feature"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"This is the ID of the product you want to feature. You can find this in the product management page."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Order"}),e.jsx("input",{type:"number",name:"order",value:l.order,onChange:o,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{name:"isActive",value:l.isActive,onChange:o,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:!0,children:"Active"}),e.jsx("option",{value:!1,children:"Inactive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",name:"startDate",value:l.startDate,onChange:o,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",name:"endDate",value:l.endDate,onChange:o,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Link URL"}),e.jsx("input",{type:"url",name:"link",value:l.link,onChange:o,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Button Text"}),e.jsx("input",{type:"text",name:"buttonText",value:l.buttonText,onChange:o,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Highlight Text"}),e.jsx("input",{type:"text",name:"highlightText",value:l.highlightText,onChange:o,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Features"}),e.jsxs("div",{className:"space-y-2",children:[l.features.map((s,t)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:s,onChange:a=>P(t,a.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:`Feature ${t+1}`}),e.jsx("button",{type:"button",onClick:()=>I(t),className:"p-2 text-red-500 hover:text-red-700",children:e.jsx(h,{size:20})})]},t)),e.jsxs("button",{type:"button",onClick:E,className:"flex items-center text-blue-600 hover:text-blue-700",children:[e.jsx(D,{size:20,className:"mr-1"}),"Add Feature"]})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Specifications"}),e.jsxs("div",{className:"space-y-2",children:[Array.from(l.specifications.entries()).map(([s,t],a)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:s,onChange:r=>{const c=new Map(l.specifications);c.delete(s),c.set(r.target.value,t),n(d=>({...d,specifications:c}))},className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Specification name"}),e.jsx("input",{type:"text",value:t,onChange:r=>A(s,r.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Specification value"}),e.jsx("button",{type:"button",onClick:()=>T(s),className:"p-2 text-red-500 hover:text-red-700",children:e.jsx(h,{size:20})})]},a)),e.jsxs("button",{type:"button",onClick:O,className:"flex items-center text-blue-600 hover:text-blue-700",children:[e.jsx(D,{size:20,className:"mr-1"}),"Add Specification"]})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SEO Title"}),e.jsx("input",{type:"text",name:"seoMetadata.title",value:l.seoMetadata.title,onChange:o,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SEO Description"}),e.jsx("textarea",{name:"seoMetadata.description",value:l.seoMetadata.description,onChange:o,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:"3"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SEO Keywords"}),e.jsx("input",{type:"text",name:"seoMetadata.keywords",value:l.seoMetadata.keywords.join(", "),onChange:s=>{const t=s.target.value.split(",").map(a=>a.trim()).filter(a=>a);n(a=>({...a,seoMetadata:{...a.seoMetadata,keywords:t}}))},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter keywords separated by commas"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>b("/admin/featured-products"),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:N.isLoading||v.isLoading,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:m?"Update Featured Product":"Create Featured Product"})]})]})]})})};export{W as default};
