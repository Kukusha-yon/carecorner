import{f as w,g as ie,h as ne,r as n,b as le,u as N,j as e,m,L as g,X as ce,S as oe,e as D,i as de}from"./index-DFyuifyJ.js";import{g as me}from"./productService-DI1icBLi.js";import{a as xe}from"./featuredProductService-CWJSp5U4.js";import{a as he}from"./newArrivalService-BWgqCLlP.js";import{A as ge}from"./arrow-left-D39ZzlRx.js";import{S as O}from"./star-DahzeS3x.js";import{C as v}from"./chevron-up-HHfOeKL0.js";import{C as b}from"./chevron-down-Bmnaw9AJ.js";/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],ue=w("check",ye);/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],L=w("chevron-right",fe);/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]],je=w("heart",pe);/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],ve=w("zoom-in",Ne),Ae=()=>{var R,_;const{id:c}=ie(),k=ne(),p=k.pathname.startsWith("/new-arrivals/"),[S,T]=n.useState(0),[o,Z]=n.useState({description:!0,specifications:!1,features:!1,reviews:!1}),[h,I]=n.useState(!1),[$,F]=n.useState({x:0,y:0}),y=n.useRef(null),{addToCart:z}=le(),[u,q]=n.useState(1),[i,K]=n.useState(p),{data:r,isLoading:W,error:f}=N({queryKey:["product",c],queryFn:()=>me(c),retry:!1,enabled:!p}),{data:d,isLoading:B}=N({queryKey:["featuredProduct",c],queryFn:()=>xe(c),enabled:!!r}),X=d?{...r,...d,name:d.featuredTitle||(r==null?void 0:r.name),description:d.featuredDescription||(r==null?void 0:r.description),image:d.featuredImage||(r==null?void 0:r.image),galleryImages:d.featuredGalleryImages||(r==null?void 0:r.galleryImages)}:r;n.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]);const{data:H,isLoading:Q,error:Y}=N({queryKey:["newArrival",c],queryFn:()=>he(c),enabled:i,retry:!1,onError:t=>{console.error("Failed to fetch item:",t)}}),s=i?H:X,G=i?Q:W,J=i?Y:f;n.useEffect(()=>{console.log("Current state:",{isNewArrivalPath:p,isNewArrival:i,product:r,featuredProduct:d,productError:f,isLoadingFeatured:B})},[p,i,r,d,f,B]),n.useEffect(()=>{f&&!i&&(console.log("Product fetch failed, trying new arrival"),K(!0))},[f,i]);const{data:C}=N({queryKey:["relatedProducts",c,s==null?void 0:s.category],queryFn:async()=>s!=null&&s.category?(await de.get(`/products/category/${encodeURIComponent(s.category)}`)).data.filter(a=>a._id!==c).slice(0,4):[],enabled:!!(s!=null&&s.category)}),V=()=>{if(s){if(!i&&s.countInStock===0){D.error("This item is out of stock");return}z({...s,isNewArrival:i},u),D.success("Added to cart")}},j=t=>{Z(a=>({...a,[t]:!a[t]}))},U=t=>{if(!y.current||!h)return;const{left:a,top:l,width:M,height:P}=y.current.getBoundingClientRect(),A=Math.min(Math.max((t.clientX-a)/M,0),1),E=Math.min(Math.max((t.clientY-l)/P,0),1);F({x:A,y:E})},ee=t=>{if(!y.current||!h)return;t.preventDefault();const a=t.touches[0],{left:l,top:M,width:P,height:A}=y.current.getBoundingClientRect(),E=Math.min(Math.max((a.clientX-l)/P,0),1),re=Math.min(Math.max((a.clientY-M)/A,0),1);F({x:E,y:re})},se=()=>{x&&x[S]&&I(!0)},te=()=>{I(!1)},ae=()=>{I(!h)};if(G)return e.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#39b54a]"})});if(J||!s)return e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Item Not Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"The item you're looking for doesn't exist or has been removed."}),e.jsxs(g,{to:"/products",className:"inline-flex items-center px-4 py-2 bg-[#39b54a] text-white rounded-lg hover:bg-[#2d8f3a] transition-colors",children:[e.jsx(ge,{className:"mr-2",size:18}),"Back to Products"]})]})});const x=[s.image];return s.galleryImages&&(Array.isArray(s.galleryImages)?x.push(...s.galleryImages.map(t=>t.url)):x.push(...s.galleryImages)),e.jsx(m.div,{initial:{opacity:0,x:((R=k.state)==null?void 0:R.transition)==="slide"?50:0},animate:{opacity:1,x:0},exit:{opacity:0,x:((_=k.state)==null?void 0:_.transition)==="slide"?-50:0},transition:{duration:.3,ease:"easeOut"},children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("nav",{className:"mb-8",children:e.jsxs("ol",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("li",{children:e.jsx(g,{to:"/",className:"text-gray-500 hover:text-gray-700",children:"Home"})}),e.jsxs("li",{className:"flex items-center",children:[e.jsx(L,{className:"h-4 w-4 text-gray-400"}),e.jsx(g,{to:"/products",className:"ml-2 text-gray-500 hover:text-gray-700",children:"Products"})]}),s.category&&e.jsxs("li",{className:"flex items-center",children:[e.jsx(L,{className:"h-4 w-4 text-gray-400"}),e.jsx(g,{to:`/products?category=${s.category}`,className:"ml-2 text-gray-500 hover:text-gray-700",children:s.category})]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx(L,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"ml-2 text-gray-900 truncate max-w-xs",children:s.name})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{ref:y,className:"relative aspect-square bg-white rounded-lg overflow-hidden border border-gray-200",onMouseMove:U,onMouseEnter:se,onMouseLeave:te,onTouchMove:ee,onClick:ae,children:[e.jsx("img",{src:x[S],alt:s.name,className:`w-full h-full object-contain p-4 transition-all duration-300 ${h?"scale-150":"scale-100"}`,style:h?{transformOrigin:`${$.x*100}% ${$.y*100}%`,cursor:"zoom-out"}:{cursor:"zoom-in"}}),h&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsx(ve,{className:"h-8 w-8 text-gray-400 opacity-50"})})]}),x.length>1&&e.jsx("div",{className:"mt-4 grid grid-cols-5 gap-2",children:x.map((t,a)=>e.jsx("button",{onClick:()=>T(a),className:`relative aspect-square rounded-md overflow-hidden border ${S===a?"border-[#39b54a] ring-2 ring-[#39b54a]":"border-gray-200"}`,children:e.jsx("img",{src:t,alt:`${s.name} ${a+1}`,className:"w-full h-full object-contain p-1",onError:l=>{l.target.src="https://placehold.co/400x400?text=No+Image"}})},a))})]}),e.jsxs("div",{children:[e.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s.name}),s.brand&&e.jsxs("div",{className:"mt-2 flex items-center",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Brand: "}),e.jsx(g,{to:`/brand/${s.brand}`,className:"ml-1 text-sm font-medium text-[#39b54a] hover:underline",children:s.brand})]})]}),s.rating&&e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"mt-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex",children:[1,2,3,4,5].map(t=>e.jsx(O,{className:`h-5 w-5 ${t<Math.floor(s.rating)?"text-yellow-400":"text-gray-300"}`,fill:t<=Math.floor(s.rating)?"currentColor":"none"},t))}),e.jsxs("p",{className:"ml-2 text-sm text-gray-500",children:[s.rating.toFixed(1)," out of 5"]}),s.numReviews&&e.jsxs("p",{className:"ml-2 text-sm text-gray-500",children:["(",s.numReviews," reviews)"]})]})}),e.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"mt-4",children:[e.jsxs("div",{className:"flex items-baseline",children:[e.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:["ETB ",s.price.toFixed(2)]}),s.originalPrice&&e.jsxs("p",{className:"ml-2 text-lg text-gray-500 line-through",children:["ETB ",s.originalPrice.toFixed(2)]})]}),s.originalPrice&&e.jsxs("p",{className:"mt-1 text-sm text-green-600",children:["Save ETB ",(s.originalPrice-s.price).toFixed(2)," (",Math.round((1-s.price/s.originalPrice)*100),"% off)"]})]}),!i&&e.jsx("div",{className:"mt-4",children:s.countInStock>0?e.jsxs("div",{className:"flex items-center text-green-600",children:[e.jsx(ue,{className:"h-5 w-5 mr-1"}),e.jsx("span",{children:"In Stock"}),s.countInStock<10&&e.jsxs("span",{className:"ml-2 text-sm text-orange-600",children:["(Only ",s.countInStock," left)"]})]}):e.jsxs("div",{className:"flex items-center text-red-600",children:[e.jsx(ce,{className:"h-5 w-5 mr-1"}),e.jsx("span",{children:"Out of Stock"})]})}),e.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"mt-6",children:[(s.sku||s.modelNumber)&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.sku&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"SKU:"}),e.jsx("span",{className:"ml-2 font-medium",children:s.sku})]}),s.modelNumber&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Model:"}),e.jsx("span",{className:"ml-2 font-medium",children:s.modelNumber})]})]}),e.jsxs("div",{className:"mt-6 flex space-x-4",children:[e.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md",children:[e.jsx("button",{onClick:()=>q(Math.max(1,u-1)),className:"px-3 py-2 text-gray-600 hover:text-gray-900",disabled:u<=1,children:"-"}),e.jsx("span",{className:"px-3 py-2 border-x border-gray-300",children:u}),e.jsx("button",{onClick:()=>q(u+1),className:"px-3 py-2 text-gray-600 hover:text-gray-900",children:"+"})]}),e.jsxs("button",{onClick:V,disabled:!i&&s.countInStock===0,className:"flex-1 bg-[#39b54a] text-white px-6 py-3 rounded-md hover:bg-[#2d8f3a] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#39b54a] disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:[e.jsx(oe,{className:"h-5 w-5 mr-2"}),!i&&s.countInStock===0?"Out of Stock":"Add to Cart"]}),e.jsx("button",{className:"p-3 border border-gray-300 rounded-md hover:bg-gray-50","aria-label":"Add to wishlist",children:e.jsx(je,{className:"h-5 w-5 text-gray-600"})})]})]}),e.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"mt-8",children:[e.jsxs("div",{className:"border-b border-gray-200",children:[e.jsxs("button",{onClick:()=>j("description"),className:"flex justify-between items-center w-full py-4 text-left",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Description"}),o.description?e.jsx(v,{className:"h-5 w-5 text-gray-500"}):e.jsx(b,{className:"h-5 w-5 text-gray-500"})]}),o.description&&e.jsxs("div",{className:"pb-4 prose prose-sm max-w-none",children:[e.jsx("p",{className:"text-gray-600",children:s.description}),s.detailedDescription&&e.jsx("div",{className:"mt-4 text-gray-600 whitespace-pre-line",children:s.detailedDescription})]})]}),s.features&&s.features.length>0&&e.jsxs("div",{className:"border-b border-gray-200",children:[e.jsxs("button",{onClick:()=>j("features"),className:"flex justify-between items-center w-full py-4 text-left",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Features"}),o.features?e.jsx(v,{className:"h-5 w-5 text-gray-500"}):e.jsx(b,{className:"h-5 w-5 text-gray-500"})]}),o.features&&e.jsx("div",{className:"pb-4",children:e.jsx("ul",{className:"list-disc pl-5 space-y-2",children:s.features.map((t,a)=>e.jsx("li",{className:"text-gray-600",children:t},a))})})]}),(s.technicalSpecs||s.specifications||s.dimensions||s.weight||s.warranty)&&e.jsxs("div",{className:"border-b border-gray-200",children:[e.jsxs("button",{onClick:()=>j("specifications"),className:"flex justify-between items-center w-full py-4 text-left",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Specifications"}),o.specifications?e.jsx(v,{className:"h-5 w-5 text-gray-500"}):e.jsx(b,{className:"h-5 w-5 text-gray-500"})]}),o.specifications&&e.jsx("div",{className:"pb-4",children:e.jsxs("dl",{className:"grid grid-cols-1 gap-x-4 gap-y-4 sm:grid-cols-2",children:[s.technicalSpecs&&Object.entries(s.technicalSpecs).map(([t,a])=>e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:t}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:a})]},t)),s.specifications&&Object.entries(s.specifications).map(([t,a])=>e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:t}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:a})]},t)),s.dimensions&&e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Dimensions"}),e.jsxs("dd",{className:"mt-1 text-sm text-gray-900",children:[s.dimensions.length," x ",s.dimensions.width," x ",s.dimensions.height," ",s.dimensions.unit]})]}),s.weight&&e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Weight"}),e.jsxs("dd",{className:"mt-1 text-sm text-gray-900",children:[s.weight.value," ",s.weight.unit]})]}),s.warranty&&e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Warranty"}),e.jsxs("dd",{className:"mt-1 text-sm text-gray-900",children:[s.warranty.duration," ",s.warranty.unit,s.warranty.description&&e.jsx("span",{className:"block text-gray-500",children:s.warranty.description})]})]})]})})]}),s.reviews&&s.reviews.length>0&&e.jsxs("div",{className:"border-b border-gray-200",children:[e.jsxs("button",{onClick:()=>j("reviews"),className:"flex justify-between items-center w-full py-4 text-left",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Reviews"}),o.reviews?e.jsx(v,{className:"h-5 w-5 text-gray-500"}):e.jsx(b,{className:"h-5 w-5 text-gray-500"})]}),o.reviews&&e.jsx("div",{className:"pb-4",children:s.reviews&&s.reviews.length>0?e.jsx("div",{className:"space-y-6",children:s.reviews.map((t,a)=>e.jsxs("div",{className:"border-b border-gray-100 pb-4 last:border-0 last:pb-0",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex",children:[1,2,3,4,5].map(l=>e.jsx(O,{className:`h-4 w-4 ${l<=t.rating?"text-yellow-400":"text-gray-300"}`,fill:l<=t.rating?"currentColor":"none"},l))}),e.jsx("span",{className:"ml-2 text-sm font-medium text-gray-900",children:t.name}),e.jsx("span",{className:"ml-2 text-sm text-gray-500",children:new Date(t.createdAt).toLocaleDateString()})]}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:t.comment})]},a))}):e.jsx("p",{className:"text-sm text-gray-500",children:"No reviews yet."})})]})]})]})]}),C&&C.length>0&&e.jsxs("div",{className:"mt-16",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Related Products"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:C.map(t=>e.jsx(g,{to:`/products/${t._id}`,className:"group",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden transition-shadow duration-300 hover:shadow-lg h-full flex flex-col",children:[e.jsx("div",{className:"aspect-w-1 aspect-h-1 w-full h-48",children:e.jsx("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover object-center group-hover:scale-105 transition-transform duration-300"})}),e.jsxs("div",{className:"p-4 flex-grow flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 group-hover:text-[#39b54a] transition-colors line-clamp-2 h-12",children:t.name}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 line-clamp-2 h-10",children:t.description})]}),e.jsxs("p",{className:"mt-2 text-lg font-bold text-gray-900",children:["ETB ",t.price.toFixed(2)]})]})]})},t._id))})]})]})})};export{Ae as default};
