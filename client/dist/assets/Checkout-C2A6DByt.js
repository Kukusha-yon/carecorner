import{f as _,j as e,c as B,b as A,k as P,r as u,u as k,V as g}from"./index-DFyuifyJ.js";import{B as D}from"./Button-DN5n5fSN.js";import{c as z}from"./orderService-Hj6BzJ-j.js";import{g as C}from"./settingService-De6mkjAu.js";import{F as M}from"./XMarkIcon-DjkKpwdS.js";import{T as R}from"./truck-BF08lgha.js";/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],K=_("shield",V),L=({contactInfo:s,onClose:t})=>e.jsx("div",{className:"fixed inset-0 bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 relative",children:[e.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:e.jsx(M,{className:"h-6 w-6"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Orders Currently Not Accepted"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"We apologize, but we are currently not accepting online orders. Please contact us through one of the following channels:"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("a",{href:s==null?void 0:s.telegram,target:"_blank",rel:"noopener noreferrer",className:"block w-full py-2 px-4 bg-[#0088cc] text-white rounded-md hover:bg-[#006699] transition-colors",children:"Contact via Telegram"}),e.jsx("a",{href:s==null?void 0:s.facebook,target:"_blank",rel:"noopener noreferrer",className:"block w-full py-2 px-4 bg-[#1877f2] text-white rounded-md hover:bg-[#166fe5] transition-colors",children:"Contact via Facebook"}),e.jsxs("a",{href:`tel:${s==null?void 0:s.phone}`,className:"block w-full py-2 px-4 bg-gray-800 text-white rounded-md hover:bg-gray-700 transition-colors",children:["Call us: ",s==null?void 0:s.phone]}),e.jsxs("a",{href:`mailto:${s==null?void 0:s.email}`,className:"block w-full py-2 px-4 bg-gray-800 text-white rounded-md hover:bg-gray-700 transition-colors",children:["Email us: ",s==null?void 0:s.email]})]})]})]})}),U=()=>{const s=B(),{cartItems:t,clearCart:S}=A(),{user:l}=P(),[F,f]=u.useState(!1),[c,o]=u.useState(""),[r,q]=u.useState({fullName:(l==null?void 0:l.name)||"",email:(l==null?void 0:l.email)||"",phone:"",address:"",city:"",state:"",additionalInfo:""}),[E,N]=u.useState(!1),{data:p}=k({queryKey:["setting","acceptOrders"],queryFn:()=>C("acceptOrders")}),{data:b}=k({queryKey:["setting","contactInfo"],queryFn:()=>C("contactInfo")});u.useEffect(()=>{if(!l){s("/login",{state:{from:"/checkout"}});return}t.length===0&&s("/cart")},[l,t,s]);const d=a=>{const{name:m,value:n}=a.target;q(h=>({...h,[m]:n}))},O=async a=>{if(a.preventDefault(),!(p!=null&&p.value)){N(!0);return}if(!localStorage.getItem("token")){g.error("Please login to place an order"),s("/login",{state:{from:"/checkout"}});return}if(!c){g.error("Please select a payment method");return}f(!0);try{const n=t.reduce((i,w)=>i+w.price*w.quantity,0);localStorage.setItem("last_cart_total",n.toString());const h=[...t];localStorage.setItem("last_order_items",JSON.stringify(h));const v={items:t.map(i=>({product:i._id,productType:i.isNewArrival?"newArrival":"product",quantity:i.quantity,price:i.price,name:i.name||i.title})),shippingDetails:{fullName:r.fullName,email:r.email,phoneNumber:r.phone,address:r.address,city:r.city,state:r.state,additionalInfo:r.additionalInfo},paymentMethod:c,totalAmount:n};console.log("Sending order data:",v);const x=await z(v);console.log("Order created successfully:",x),g.success("Order placed successfully!"),sessionStorage.setItem("orderSuccess","true"),x&&x._id&&sessionStorage.setItem("lastOrderId",x._id),S(),s("/order-success",{state:{from:"checkout",orderId:x._id,orderItems:h}})}catch(n){g.error(n.message||"Failed to place order"),console.error("Error details:",n)}finally{f(!1)}},y=t.reduce((a,m)=>a+m.price*m.quantity,0),j=y>0?10:0,T=y+j;return e.jsxs("div",{className:"min-h-screen bg-gray-50 pt-24",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-8",children:"Checkout"}),e.jsxs("div",{className:"lg:grid lg:grid-cols-12 lg:gap-x-12",children:[e.jsx("div",{className:"lg:col-span-7",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Shipping Address"}),e.jsxs("form",{onSubmit:O,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700",children:["Full Name ",e.jsx("span",{className:"text-green-500",children:"*"})]}),e.jsx("input",{type:"text",id:"fullName",name:"fullName",value:r.fullName,onChange:d,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#39b54a] focus:ring-[#39b54a]"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:["Email ",e.jsx("span",{className:"text-green-500",children:"*"})]}),e.jsx("input",{type:"email",id:"email",name:"email",value:r.email,onChange:d,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#39b54a] focus:ring-[#39b54a]"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:["Phone Number ",e.jsx("span",{className:"text-green-500",children:"*"})]}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:r.phone,onChange:d,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#39b54a] focus:ring-[#39b54a]"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700",children:["Street Address ",e.jsx("span",{className:"text-green-500",children:"*"})]}),e.jsx("input",{type:"text",id:"address",name:"address",value:r.address,onChange:d,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#39b54a] focus:ring-[#39b54a]"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700",children:["City ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"city",name:"city",value:r.city,onChange:d,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#39b54a] focus:ring-[#39b54a]"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"state",className:"block text-sm font-medium text-gray-700",children:["State/Region ",e.jsx("span",{className:"text-green-500",children:"*"})]}),e.jsx("input",{type:"text",id:"state",name:"state",value:r.state,onChange:d,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#39b54a] focus:ring-[#39b54a]"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"additionalInfo",className:"block text-sm font-medium text-gray-700",children:"Additional Information (Optional)"}),e.jsx("textarea",{id:"additionalInfo",name:"additionalInfo",value:r.additionalInfo,onChange:d,rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#39b54a] focus:ring-[#39b54a]"})]}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Payment Method ",e.jsx("span",{className:"text-green-500",children:"*"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-4 p-4 border rounded-lg cursor-pointer hover:border-[#39b54a]",onClick:()=>o("telebirr"),children:[e.jsx("input",{type:"radio",name:"payment",checked:c==="telebirr",onChange:()=>o("telebirr"),className:"h-4 w-4 text-[#39b54a] focus:ring-[#39b54a]"}),e.jsx("img",{src:"/images/telebirr-logo.png",alt:"Telebirr",className:"h-8"}),e.jsx("span",{className:"text-sm font-medium",children:"Telebirr"})]}),e.jsxs("div",{className:"flex items-center space-x-4 p-4 border rounded-lg cursor-pointer hover:border-[#39b54a]",onClick:()=>o("abyssinia"),children:[e.jsx("input",{type:"radio",name:"payment",checked:c==="abyssinia",onChange:()=>o("abyssinia"),className:"h-4 w-4 text-[#39b54a] focus:ring-[#39b54a]"}),e.jsx("img",{src:"/images/abyssinia-logo.png",alt:"Bank of Abyssinia",className:"h-8"}),e.jsx("span",{className:"text-sm font-medium",children:"Bank of Abyssinia"})]}),e.jsxs("div",{className:"flex items-center space-x-4 p-4 border rounded-lg cursor-pointer hover:border-[#39b54a]",onClick:()=>o("cbe"),children:[e.jsx("input",{type:"radio",name:"payment",checked:c==="cbe",onChange:()=>o("cbe"),className:"h-4 w-4 text-[#39b54a] focus:ring-[#39b54a]"}),e.jsx("img",{src:"/images/cbe-logo.png",alt:"Commercial Bank of Ethiopia",className:"h-8"}),e.jsx("span",{className:"text-sm font-medium",children:"Commercial Bank of Ethiopia"})]})]})]}),e.jsx("div",{className:"mt-8",children:e.jsx(D,{type:"submit",variant:"primary",size:"lg",className:"w-full bg-[#39b54a] hover:bg-[#2d8f3a] text-white font-medium",loading:F,children:"Place Order"})})]})]})}),e.jsx("div",{className:"lg:col-span-5 mt-8 lg:mt-0",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 sticky top-24",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Order Summary"}),e.jsxs("div",{className:"space-y-4",children:[t.map(a=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:a.image,alt:a.title||a.name,className:"w-16 h-16 object-cover rounded-lg"}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:a.title||a.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Qty: ",a.quantity]})]}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["ETB ",((a.price||0)*a.quantity).toFixed(2)]})]},a._id)),e.jsxs("div",{className:"border-t border-gray-200 pt-4 space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Subtotal"}),e.jsxs("span",{className:"text-gray-900",children:["ETB ",y.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Shipping & handling"}),e.jsxs("span",{className:"text-gray-900",children:["ETB ",j.toFixed(2)]})]}),e.jsx("div",{className:"border-t border-gray-200 pt-4",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-lg font-medium text-gray-900",children:"Total"}),e.jsxs("span",{className:"text-lg font-medium text-gray-900",children:["ETB ",T.toFixed(2)]})]})})]})]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Free shipping on orders over ETB 1,000"]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Secure checkout"]})]})]})})]})]}),E&&e.jsx(L,{contactInfo:b==null?void 0:b.value,onClose:()=>N(!1)})]})};export{U as default};
