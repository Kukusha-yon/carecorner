import{z as E,r as c,u as S,j as e,D as F,e as l,E as M,H as q,I as D}from"./index-DFyuifyJ.js";import{u as g}from"./useMutation-C0jg7rW6.js";const I=()=>{const u=E(),[f,i]=c.useState(!1),[d,m]=c.useState(null),[a,n]=c.useState({name:"",logo:null,link:"",order:0}),[p,x]=c.useState(""),{data:h,isLoading:b}=S({queryKey:["partners"],queryFn:D}),y=g({mutationFn:q,onSuccess:()=>{u.invalidateQueries(["partners"]),l.success("Partner added successfully"),i(!1),o()},onError:t=>{var s,r;l.error(((r=(s=t.response)==null?void 0:s.data)==null?void 0:r.message)||"Error adding partner")}}),j=g({mutationFn:({id:t,data:s})=>M(t,s),onSuccess:()=>{u.invalidateQueries(["partners"]),l.success("Partner updated successfully"),i(!1),m(null),o()},onError:t=>{var s,r;l.error(((r=(s=t.response)==null?void 0:s.data)==null?void 0:r.message)||"Error updating partner")}}),N=g({mutationFn:F,onSuccess:()=>{u.invalidateQueries(["partners"]),l.success("Partner deleted successfully")},onError:t=>{var s,r;l.error(((r=(s=t.response)==null?void 0:s.data)==null?void 0:r.message)||"Error deleting partner")}}),w=t=>{t.preventDefault(),d?j.mutate({id:d._id,data:a}):y.mutate(a)},v=t=>{m(t),n({name:t.name,logo:null,link:t.link,order:t.order}),x(t.logo),i(!0)},k=t=>{window.confirm("Are you sure you want to delete this partner?")&&N.mutate(t)},o=()=>{n({name:"",logo:null,link:"",order:0}),x(""),m(null)},P=t=>{const s=t.target.files[0];if(s){n({...a,logo:s});const r=new FileReader;r.onloadend=()=>{x(r.result)},r.readAsDataURL(s)}},C=()=>{o(),i(!0)};return b?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Partners Management"}),e.jsx("button",{onClick:C,className:"bg-[#39b54a] text-white px-4 py-2 rounded-lg hover:bg-[#2d8f3a] transition-colors",children:"Add New Partner"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Logo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Link"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h==null?void 0:h.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("img",{src:t.logo,alt:t.name,className:"h-10 w-auto object-contain"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("a",{href:t.link,target:"_blank",rel:"noopener noreferrer",className:"text-[#39b54a] hover:text-[#2d8f3a]",children:t.link})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.order}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("button",{onClick:()=>v(t),className:"text-[#39b54a] hover:text-[#2d8f3a] mr-4",children:"Edit"}),e.jsx("button",{onClick:()=>k(t._id),className:"text-red-600 hover:text-red-800",children:"Delete"})]})]},t._id))})]})}),f&&e.jsx("div",{className:"fixed inset-0 bg-opacity-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:d?"Edit Partner":"Add New Partner"}),e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:a.name,onChange:t=>n({...a,name:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#39b54a]",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Logo"}),e.jsxs("div",{className:"mt-1 flex items-center",children:[e.jsx("div",{className:"w-20 h-20 border-2 border-dashed border-gray-300 rounded-lg overflow-hidden mr-4",children:p?e.jsx("img",{src:p,alt:"Preview",className:"w-full h-full object-contain"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:"No image"})}),e.jsx("input",{type:"file",accept:"image/*",onChange:P,className:"hidden",id:"logo-upload"}),e.jsx("label",{htmlFor:"logo-upload",className:"cursor-pointer bg-white px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#39b54a]",children:"Choose Image"})]}),!d&&!a.logo&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:"Logo is required"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Link"}),e.jsx("input",{type:"url",value:a.link,onChange:t=>n({...a,link:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#39b54a]",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order"}),e.jsx("input",{type:"number",value:a.order,onChange:t=>n({...a,order:parseInt(t.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#39b54a]",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>{i(!1),o()},className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-[#39b54a] text-white rounded-lg hover:bg-[#2d8f3a]",children:d?"Update":"Add"})]})]})]})})]})};export{I as default};
