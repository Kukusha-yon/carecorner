import{r as a,z as R,u as y,j as e,A as T,V as m}from"./index-DFyuifyJ.js";import{u as N}from"./useMutation-C0jg7rW6.js";import{u as P,d as q,b as I,e as V}from"./orderService-Hj6BzJ-j.js";import{F as _}from"./ShoppingCartIcon-GqZeZJtk.js";import{F as B}from"./CurrencyDollarIcon-Y-twnjAO.js";import{F as v}from"./XMarkIcon-DjkKpwdS.js";import{f as b}from"./format-sbWH3_uq.js";function Q({title:l,titleId:r,...d},n){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},d),l?a.createElement("title",{id:r},l):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const U=a.forwardRef(Q);function W({title:l,titleId:r,...d},n){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},d),l?a.createElement("title",{id:r},l):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const Z=a.forwardRef(W);function z({title:l,titleId:r,...d},n){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},d),l?a.createElement("title",{id:r},l):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const H=a.forwardRef(z);function K({title:l,titleId:r,...d},n){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},d),l?a.createElement("title",{id:r},l):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 0 1-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 0 0-3.213-9.193 2.056 2.056 0 0 0-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 0 0-10.026 0 1.106 1.106 0 0 0-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12"}))}const G=a.forwardRef(K),le=()=>{var j;const l=R(),[r,d]=a.useState(""),[n,w]=a.useState("all"),[t,o]=a.useState(null),[k,x]=a.useState(!1),[C,f]=a.useState(!1),[h,O]=a.useState("week"),{data:u,isLoading:F}=y({queryKey:["adminOrders"],queryFn:I}),{data:i,isLoading:D,error:Y}=y({queryKey:["orderStats",h],queryFn:()=>V(h),retry:1}),L=N({mutationFn:({id:s,status:c})=>P(s,c),onSuccess:()=>{l.invalidateQueries(["adminOrders"]),m.success("Order status updated successfully")},onError:s=>{m.error(s.message||"Failed to update order status")}}),$=N({mutationFn:q,onSuccess:()=>{l.invalidateQueries(["adminOrders"]),m.success("Order deleted successfully"),x(!1)},onError:s=>{m.error(s.message||"Failed to delete order")}}),E=async(s,c)=>{try{await L.mutateAsync({id:s,status:c})}catch(g){console.error("Error updating order status:",g)}},M=s=>{o(s),x(!0)},A=async()=>{if(t)try{await $.mutateAsync(t._id),o(null),x(!1)}catch(s){console.error("Error deleting order:",s)}},S=s=>{o(s),f(!0)},p=u==null?void 0:u.filter(s=>{const c=s._id.toLowerCase().includes(r.toLowerCase())||s.shippingDetails.fullName.toLowerCase().includes(r.toLowerCase())||s.shippingDetails.email.toLowerCase().includes(r.toLowerCase()),g=n==="all"||s.status===n;return c&&g});return F||D?e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#39b54a]"})}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Orders"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:(i==null?void 0:i.totalOrders)||0})]}),e.jsx("div",{className:"bg-[#39b54a]/10 p-3 rounded-full",children:e.jsx(_,{className:"h-6 w-6 text-[#39b54a]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:["$",((j=i==null?void 0:i.totalRevenue)==null?void 0:j.toFixed(2))||"0.00"]})]}),e.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:e.jsx(B,{className:"h-6 w-6 text-blue-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending Orders"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:(i==null?void 0:i.pendingOrders)||0})]}),e.jsx("div",{className:"bg-yellow-100 p-3 rounded-full",children:e.jsx(T,{className:"h-6 w-6 text-yellow-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Delivered Orders"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:(i==null?void 0:i.deliveredOrders)||0})]}),e.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:e.jsx(G,{className:"h-6 w-6 text-green-600"})})]})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow mb-8",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search orders...",value:r,onChange:s=>d(s.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#39b54a] focus:border-transparent"})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsxs("select",{value:n,onChange:s=>w(s.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#39b54a] focus:border-transparent appearance-none bg-white",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"shipped",children:"Shipped"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("select",{value:h,onChange:s=>O(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#39b54a] focus:border-transparent",children:[e.jsx("option",{value:"week",children:"Last 7 Days"}),e.jsx("option",{value:"month",children:"Last 30 Days"}),e.jsx("option",{value:"year",children:"Last Year"})]})]})]})})}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p==null?void 0:p.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s._id.slice(-6).toUpperCase()})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:s.shippingDetails.fullName}),e.jsx("div",{className:"text-sm text-gray-500",children:s.shippingDetails.email})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-900",children:["$",s.totalAmount.toFixed(2)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                      ${s.status==="pending"?"bg-yellow-100 text-yellow-800":""}
                      ${s.status==="processing"?"bg-blue-100 text-blue-800":""}
                      ${s.status==="shipped"?"bg-purple-100 text-purple-800":""}
                      ${s.status==="delivered"?"bg-green-100 text-green-800":""}
                      ${s.status==="cancelled"?"bg-red-100 text-red-800":""}`,children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:b(new Date(s.createdAt),"MMM d, yyyy")})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[e.jsx("button",{onClick:()=>S(s),className:"text-blue-600 hover:text-blue-900",children:e.jsx(U,{className:"h-5 w-5"})}),e.jsxs("select",{value:s.status,onChange:c=>E(s._id,c.target.value),className:"text-sm border rounded px-2 py-1 focus:ring-2 focus:ring-[#39b54a] focus:border-transparent",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"shipped",children:"Shipped"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]}),e.jsx("button",{onClick:()=>M(s),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},s._id))})]})})}),C&&t&&e.jsx("div",{className:"fixed inset-0 bg-opacity-75 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Order Details"}),e.jsx("button",{onClick:()=>{f(!1),o(null)},className:"text-gray-400 hover:text-gray-500",children:e.jsx(v,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Order Information"}),e.jsxs("dl",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Order ID"}),e.jsx("dd",{className:"text-sm text-gray-900",children:t._id})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Order Date"}),e.jsx("dd",{className:"text-sm text-gray-900",children:b(new Date(t.createdAt),"MMM d, yyyy")})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Status"}),e.jsx("dd",{className:"text-sm text-gray-900",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                          ${t.status==="pending"?"bg-yellow-100 text-yellow-800":""}
                          ${t.status==="processing"?"bg-blue-100 text-blue-800":""}
                          ${t.status==="shipped"?"bg-purple-100 text-purple-800":""}
                          ${t.status==="delivered"?"bg-green-100 text-green-800":""}
                          ${t.status==="cancelled"?"bg-red-100 text-red-800":""}`,children:t.status.charAt(0).toUpperCase()+t.status.slice(1)})})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Total Amount"}),e.jsxs("dd",{className:"text-sm text-gray-900",children:["$",t.totalAmount.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Payment Method"}),e.jsxs("dd",{className:"text-sm text-gray-900",children:[t.paymentMethod==="telebirr"&&"Telebirr",t.paymentMethod==="abyssinia"&&"Bank of Abyssinia",t.paymentMethod==="cbe"&&"Commercial Bank of Ethiopia"]})]})]})]}),e.jsxs("div",{className:"bg-transparent",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Shipping Information"}),e.jsxs("dl",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Full Name"}),e.jsx("dd",{className:"text-sm text-gray-900",children:t.shippingDetails.fullName})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Email"}),e.jsx("dd",{className:"text-sm text-gray-900",children:t.shippingDetails.email})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Phone"}),e.jsx("dd",{className:"text-sm text-gray-900",children:t.shippingDetails.phoneNumber})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Address"}),e.jsx("dd",{className:"text-sm text-gray-900",children:t.shippingDetails.address})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Order Items"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Product"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Quantity"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Price"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.items.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[s.image&&e.jsx("img",{src:s.image,alt:s.name,className:"h-10 w-10 rounded-md object-cover mr-3"}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.quantity}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["$",s.price.toFixed(2)]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",(s.price*s.quantity).toFixed(2)]})]},s._id))})]})})]}),e.jsx("div",{className:"border-t border-gray-200 pt-6",children:e.jsx("div",{className:"flex justify-end",children:e.jsx("div",{className:"w-64",children:e.jsxs("dl",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"Subtotal"}),e.jsxs("dd",{className:"text-sm text-gray-900",children:["$",t.totalAmount.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"Shipping & handling"}),e.jsx("dd",{className:"text-sm text-gray-900",children:"$10.00"})]}),e.jsxs("div",{className:"flex justify-between border-t border-gray-200 pt-2",children:[e.jsx("dt",{className:"text-base font-medium text-gray-900",children:"Total"}),e.jsxs("dd",{className:"text-base font-medium text-gray-900",children:["$",(t.totalAmount+10).toFixed(2)]})]})]})})})})]})})}),k&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[e.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx(v,{className:"h-6 w-6 text-red-600","aria-hidden":"true"})}),e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Order"}),e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this order? This action cannot be undone."})})]})]})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:A,children:"Delete"}),e.jsx("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>{x(!1),o(null)},children:"Cancel"})]})]})]})})]})};export{le as default};
